[2020-07-21 17:27:40,015] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: MYSQLDAG.dbdump_in_minio 2020-07-21T11:55:07.728690+00:00 [queued]>
[2020-07-21 17:27:40,050] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: MYSQLDAG.dbdump_in_minio 2020-07-21T11:55:07.728690+00:00 [queued]>
[2020-07-21 17:27:40,050] {taskinstance.py:879} INFO - 
--------------------------------------------------------------------------------
[2020-07-21 17:27:40,050] {taskinstance.py:880} INFO - Starting attempt 2 of 2
[2020-07-21 17:27:40,050] {taskinstance.py:881} INFO - 
--------------------------------------------------------------------------------
[2020-07-21 17:27:40,297] {taskinstance.py:900} INFO - Executing <Task(BashOperator): dbdump_in_minio> on 2020-07-21T11:55:07.728690+00:00
[2020-07-21 17:27:40,301] {standard_task_runner.py:53} INFO - Started process 86240 to run task
[2020-07-21 17:27:40,550] {logging_mixin.py:112} INFO - Running %s on host %s <TaskInstance: MYSQLDAG.dbdump_in_minio 2020-07-21T11:55:07.728690+00:00 [running]> bhakti-Vostro-3558
[2020-07-21 17:27:40,586] {bash_operator.py:82} INFO - Tmp dir root location: 
 /tmp
[2020-07-21 17:27:40,588] {bash_operator.py:103} INFO - Temporary script location: /tmp/airflowtmpetzgmxxc/dbdump_in_minio5gyzd_5l
[2020-07-21 17:27:40,588] {bash_operator.py:115} INFO - Running command: #!/bin/bash -x
user=root
password=
dbname=airflow_db2
root_dir="/home/bhakti/airflow/"
location=$root_dir"input_data/dump_mysql_db.db"
if [ $dbname != " " ]
then
docker exec -it mysqlCon \
mysqldump --user $user --databases $dbname > $location
python3 $root_dir"minioconnect/minio_connection.py"
echo 'File uploaded successfully'
/opt/spark/bin/spark-submit airflow/config/settings.py
fi
[2020-07-21 17:27:40,605] {bash_operator.py:122} INFO - Output:
[2020-07-21 17:27:40,667] {bash_operator.py:126} INFO - Error response from daemon: Container 0b8c6cff7c56db07d3348ae907586349e88a15c73fb796424ab422908a3d38f5 is not running
[2020-07-21 17:27:41,867] {bash_operator.py:126} INFO - mysqldump2020-07-21 17:27:41.867303.sql
[2020-07-21 17:27:41,869] {bash_operator.py:126} INFO - [2020-07-21 17:27:41,869] {connectionpool.py:744} WARNING - Retrying ('\x1b[1mRetry(total=4, connect=None, read=None, redirect=None, status=None)\x1b[0m') after connection broken by ''\x1b[1m<urllib3.connection.HTTPConnection object at 0x7efe7fa6b310>: Failed to establish a new connection: [Errno 111] Connection refused\x1b[0m'': /airflowbucket?location=
[2020-07-21 17:27:42,271] {bash_operator.py:126} INFO - [2020-07-21 17:27:42,270] {connectionpool.py:744} WARNING - Retrying ('\x1b[1mRetry(total=3, connect=None, read=None, redirect=None, status=None)\x1b[0m') after connection broken by ''\x1b[1m<urllib3.connection.HTTPConnection object at 0x7efe7fa6b9d0>: Failed to establish a new connection: [Errno 111] Connection refused\x1b[0m'': /airflowbucket?location=
[2020-07-21 17:27:43,074] {bash_operator.py:126} INFO - [2020-07-21 17:27:43,073] {connectionpool.py:744} WARNING - Retrying ('\x1b[1mRetry(total=2, connect=None, read=None, redirect=None, status=None)\x1b[0m') after connection broken by ''\x1b[1m<urllib3.connection.HTTPConnection object at 0x7efe7fa6bb50>: Failed to establish a new connection: [Errno 111] Connection refused\x1b[0m'': /airflowbucket?location=
[2020-07-21 17:27:44,676] {bash_operator.py:126} INFO - [2020-07-21 17:27:44,676] {connectionpool.py:744} WARNING - Retrying ('\x1b[1mRetry(total=1, connect=None, read=None, redirect=None, status=None)\x1b[0m') after connection broken by ''\x1b[1m<urllib3.connection.HTTPConnection object at 0x7efe7fa6bcd0>: Failed to establish a new connection: [Errno 111] Connection refused\x1b[0m'': /airflowbucket?location=
[2020-07-21 17:27:47,882] {bash_operator.py:126} INFO - [2020-07-21 17:27:47,881] {connectionpool.py:744} WARNING - Retrying ('\x1b[1mRetry(total=0, connect=None, read=None, redirect=None, status=None)\x1b[0m') after connection broken by ''\x1b[1m<urllib3.connection.HTTPConnection object at 0x7efe7fa6be50>: Failed to establish a new connection: [Errno 111] Connection refused\x1b[0m'': /airflowbucket?location=
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO - Traceback (most recent call last):
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connection.py", line 156, in _new_conn
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO -     conn = connection.create_connection(
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/util/connection.py", line 84, in create_connection
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO -     raise err
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/util/connection.py", line 74, in create_connection
[2020-07-21 17:27:47,907] {bash_operator.py:126} INFO -     sock.connect(sa)
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO - ConnectionRefusedError: [Errno 111] Connection refused
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO - 
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO - During handling of the above exception, another exception occurred:
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO - 
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO - Traceback (most recent call last):
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 665, in urlopen
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO -     httplib_response = self._make_request(
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 387, in _make_request
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO -     conn.request(method, url, **httplib_request_kw)
[2020-07-21 17:27:47,908] {bash_operator.py:126} INFO -   File "/usr/lib/python3.8/http/client.py", line 1240, in request
[2020-07-21 17:27:47,909] {bash_operator.py:126} INFO -     self._send_request(method, url, body, headers, encode_chunked)
[2020-07-21 17:27:47,909] {bash_operator.py:126} INFO -   File "/usr/lib/python3.8/http/client.py", line 1286, in _send_request
[2020-07-21 17:27:47,909] {bash_operator.py:126} INFO -     self.endheaders(body, encode_chunked=encode_chunked)
[2020-07-21 17:27:47,909] {bash_operator.py:126} INFO -   File "/usr/lib/python3.8/http/client.py", line 1235, in endheaders
[2020-07-21 17:27:47,910] {bash_operator.py:126} INFO -     self._send_output(message_body, encode_chunked=encode_chunked)
[2020-07-21 17:27:47,910] {bash_operator.py:126} INFO -   File "/usr/lib/python3.8/http/client.py", line 1006, in _send_output
[2020-07-21 17:27:47,910] {bash_operator.py:126} INFO -     self.send(msg)
[2020-07-21 17:27:47,910] {bash_operator.py:126} INFO -   File "/usr/lib/python3.8/http/client.py", line 946, in send
[2020-07-21 17:27:47,910] {bash_operator.py:126} INFO -     self.connect()
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connection.py", line 184, in connect
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO -     conn = self._new_conn()
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connection.py", line 168, in _new_conn
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO -     raise NewConnectionError(
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO - urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7efe7fa6bfd0>: Failed to establish a new connection: [Errno 111] Connection refused
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO - 
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO - During handling of the above exception, another exception occurred:
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO - 
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO - Traceback (most recent call last):
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO -   File "/home/bhakti/airflow/minioconnect/minio_connection.py", line 26, in <module>
[2020-07-21 17:27:47,911] {bash_operator.py:126} INFO -     minioClient.fput_object(bucket, bucket_file_name, '/home/bhakti/airflow/input_data/dump_mysql_db.db')
[2020-07-21 17:27:47,912] {bash_operator.py:126} INFO -   File "/usr/local/lib/python3.8/dist-packages/minio/api.py", line 698, in fput_object
[2020-07-21 17:27:47,912] {bash_operator.py:126} INFO -     return self.put_object(bucket_name, object_name, file_data,
[2020-07-21 17:27:47,912] {bash_operator.py:126} INFO -   File "/usr/local/lib/python3.8/dist-packages/minio/api.py", line 969, in put_object
[2020-07-21 17:27:47,912] {bash_operator.py:126} INFO -     return self._do_put_object(bucket_name, object_name,
[2020-07-21 17:27:47,912] {bash_operator.py:126} INFO -   File "/usr/local/lib/python3.8/dist-packages/minio/api.py", line 1682, in _do_put_object
[2020-07-21 17:27:47,913] {bash_operator.py:126} INFO -     response = self._url_open(
[2020-07-21 17:27:47,913] {bash_operator.py:126} INFO -   File "/usr/local/lib/python3.8/dist-packages/minio/api.py", line 1984, in _url_open
[2020-07-21 17:27:47,913] {bash_operator.py:126} INFO -     region = self._get_bucket_region(bucket_name)
[2020-07-21 17:27:47,913] {bash_operator.py:126} INFO -   File "/usr/local/lib/python3.8/dist-packages/minio/api.py", line 1919, in _get_bucket_region
[2020-07-21 17:27:47,914] {bash_operator.py:126} INFO -     region = self._get_bucket_location(bucket_name)
[2020-07-21 17:27:47,914] {bash_operator.py:126} INFO -   File "/usr/local/lib/python3.8/dist-packages/minio/api.py", line 1948, in _get_bucket_location
[2020-07-21 17:27:47,914] {bash_operator.py:126} INFO -     response = self._http.urlopen(method, url,
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/poolmanager.py", line 330, in urlopen
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -     response = conn.urlopen(method, u.request_uri, **kw)
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 747, in urlopen
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -     return self.urlopen(
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 747, in urlopen
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -     return self.urlopen(
[2020-07-21 17:27:47,915] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 747, in urlopen
[2020-07-21 17:27:47,916] {bash_operator.py:126} INFO -     return self.urlopen(
[2020-07-21 17:27:47,916] {bash_operator.py:126} INFO -   [Previous line repeated 2 more times]
[2020-07-21 17:27:47,916] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/connectionpool.py", line 719, in urlopen
[2020-07-21 17:27:47,916] {bash_operator.py:126} INFO -     retries = retries.increment(
[2020-07-21 17:27:47,916] {bash_operator.py:126} INFO -   File "/usr/lib/python3/dist-packages/urllib3/util/retry.py", line 436, in increment
[2020-07-21 17:27:47,916] {bash_operator.py:126} INFO -     raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2020-07-21 17:27:47,917] {bash_operator.py:126} INFO - urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=9000): Max retries exceeded with url: /airflowbucket?location= (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efe7fa6bfd0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2020-07-21 17:27:48,051] {bash_operator.py:126} INFO - File uploaded successfully
[2020-07-21 17:27:49,682] {bash_operator.py:126} INFO - 20/07/21 17:27:49 WARN Utils: Your hostname, bhakti-Vostro-3558 resolves to a loopback address: 127.0.1.1; using 192.168.43.94 instead (on interface wlp6s0)
[2020-07-21 17:27:49,683] {bash_operator.py:126} INFO - 20/07/21 17:27:49 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
[2020-07-21 17:27:50,660] {bash_operator.py:126} INFO - 20/07/21 17:27:50 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2020-07-21 17:27:51,246] {bash_operator.py:126} INFO - python3: can't open file '/tmp/airflowtmpetzgmxxc/airflow/config/settings.py': [Errno 2] No such file or directory
[2020-07-21 17:27:51,258] {bash_operator.py:126} INFO - log4j:WARN No appenders could be found for logger (org.apache.spark.util.ShutdownHookManager).
[2020-07-21 17:27:51,258] {bash_operator.py:126} INFO - log4j:WARN Please initialize the log4j system properly.
[2020-07-21 17:27:51,258] {bash_operator.py:126} INFO - log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
[2020-07-21 17:27:51,282] {bash_operator.py:128} INFO - Command exited with return code 2
[2020-07-21 17:27:51,290] {taskinstance.py:1145} ERROR - Bash command failed
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 983, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/bash_operator.py", line 134, in execute
    raise AirflowException("Bash command failed")
airflow.exceptions.AirflowException: Bash command failed
[2020-07-21 17:27:51,292] {taskinstance.py:1174} INFO - All retries failed; marking task as FAILED.dag_id=MYSQLDAG, task_id=dbdump_in_minio, execution_date=20200721T115507, start_date=20200721T115740, end_date=20200721T115751
[2020-07-21 17:27:54,919] {logging_mixin.py:112} INFO - [2020-07-21 17:27:54,919] {local_task_job.py:103} INFO - Task exited with return code 1
