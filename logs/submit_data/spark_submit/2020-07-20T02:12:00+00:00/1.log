[2020-07-22 13:59:01,583] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: submit_data.spark_submit 2020-07-20T02:12:00+00:00 [queued]>
[2020-07-22 13:59:01,597] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: submit_data.spark_submit 2020-07-20T02:12:00+00:00 [queued]>
[2020-07-22 13:59:01,598] {taskinstance.py:879} INFO - 
--------------------------------------------------------------------------------
[2020-07-22 13:59:01,598] {taskinstance.py:880} INFO - Starting attempt 1 of 1
[2020-07-22 13:59:01,598] {taskinstance.py:881} INFO - 
--------------------------------------------------------------------------------
[2020-07-22 13:59:01,760] {taskinstance.py:900} INFO - Executing <Task(SparkSubmitOperator): spark_submit> on 2020-07-20T02:12:00+00:00
[2020-07-22 13:59:01,766] {standard_task_runner.py:53} INFO - Started process 385630 to run task
[2020-07-22 13:59:02,048] {logging_mixin.py:112} INFO - Running %s on host %s <TaskInstance: submit_data.spark_submit 2020-07-20T02:12:00+00:00 [running]> bhakti-Vostro-3558
[2020-07-22 13:59:02,081] {logging_mixin.py:112} INFO - [2020-07-22 13:59:02,081] {base_hook.py:87} INFO - Using connection to: id: spark_local. Host: yarn, Port: 4040, Schema: None, Login: None, Password: None, extra: None
[2020-07-22 13:59:02,082] {logging_mixin.py:112} INFO - [2020-07-22 13:59:02,082] {spark_submit_hook.py:325} INFO - Spark-Submit cmd: spark-submit --master yarn:4040 --name airflow-spark /home/bhakti/airflow/spark_jobs/python/spark_test.py
[2020-07-22 13:59:04,822] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,821] {spark_submit_hook.py:479} INFO - 20/07/22 13:59:04 WARN Utils: Your hostname, bhakti-Vostro-3558 resolves to a loopback address: 127.0.1.1; using 192.168.43.94 instead (on interface wlp6s0)
[2020-07-22 13:59:04,827] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,827] {spark_submit_hook.py:479} INFO - 20/07/22 13:59:04 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
[2020-07-22 13:59:04,971] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,971] {spark_submit_hook.py:479} INFO - Exception in thread "main" org.apache.spark.SparkException: When running with master 'yarn:4040' either HADOOP_CONF_DIR or YARN_CONF_DIR must be set in the environment.
[2020-07-22 13:59:04,972] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,972] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmitArguments.error(SparkSubmitArguments.scala:630)
[2020-07-22 13:59:04,972] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,972] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmitArguments.validateSubmitArguments(SparkSubmitArguments.scala:270)
[2020-07-22 13:59:04,972] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,972] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmitArguments.validateArguments(SparkSubmitArguments.scala:233)
[2020-07-22 13:59:04,973] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,973] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmitArguments.<init>(SparkSubmitArguments.scala:119)
[2020-07-22 13:59:04,973] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,973] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmit$$anon$2$$anon$3.<init>(SparkSubmit.scala:990)
[2020-07-22 13:59:04,973] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,973] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmit$$anon$2.parseArguments(SparkSubmit.scala:990)
[2020-07-22 13:59:04,991] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,991] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:85)
[2020-07-22 13:59:04,991] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,991] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)
[2020-07-22 13:59:04,992] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,991] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)
[2020-07-22 13:59:04,992] {logging_mixin.py:112} INFO - [2020-07-22 13:59:04,992] {spark_submit_hook.py:479} INFO - at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
[2020-07-22 13:59:05,044] {taskinstance.py:1145} ERROR - Cannot execute: spark-submit --master yarn:4040 --name airflow-spark /home/bhakti/airflow/spark_jobs/python/spark_test.py. Error code is: 1.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 983, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/usr/local/lib/python3.8/dist-packages/airflow/contrib/operators/spark_submit_operator.py", line 187, in execute
    self._hook.submit(self._application)
  File "/usr/local/lib/python3.8/dist-packages/airflow/contrib/hooks/spark_submit_hook.py", line 403, in submit
    raise AirflowException(
airflow.exceptions.AirflowException: Cannot execute: spark-submit --master yarn:4040 --name airflow-spark /home/bhakti/airflow/spark_jobs/python/spark_test.py. Error code is: 1.
[2020-07-22 13:59:05,047] {taskinstance.py:1189} INFO - Marking task as FAILED.dag_id=submit_data, task_id=spark_submit, execution_date=20200720T021200, start_date=20200722T082901, end_date=20200722T082905
[2020-07-22 13:59:11,416] {logging_mixin.py:112} INFO - [2020-07-22 13:59:11,415] {local_task_job.py:103} INFO - Task exited with return code 1
