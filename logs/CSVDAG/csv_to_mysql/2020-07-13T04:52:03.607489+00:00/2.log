[2020-07-13 10:24:44,313] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: CSVDAG.csv_to_mysql 2020-07-13T04:52:03.607489+00:00 [queued]>
[2020-07-13 10:24:44,327] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: CSVDAG.csv_to_mysql 2020-07-13T04:52:03.607489+00:00 [queued]>
[2020-07-13 10:24:44,327] {taskinstance.py:879} INFO - 
--------------------------------------------------------------------------------
[2020-07-13 10:24:44,327] {taskinstance.py:880} INFO - Starting attempt 2 of 2
[2020-07-13 10:24:44,327] {taskinstance.py:881} INFO - 
--------------------------------------------------------------------------------
[2020-07-13 10:24:44,474] {taskinstance.py:900} INFO - Executing <Task(PythonOperator): csv_to_mysql> on 2020-07-13T04:52:03.607489+00:00
[2020-07-13 10:24:44,477] {standard_task_runner.py:53} INFO - Started process 14607 to run task
[2020-07-13 10:24:44,696] {logging_mixin.py:112} INFO - Running %s on host %s <TaskInstance: CSVDAG.csv_to_mysql 2020-07-13T04:52:03.607489+00:00 [running]> bhakti-Vostro-3558
[2020-07-13 10:24:44,769] {taskinstance.py:1145} ERROR - (pymysql.err.InternalError) (1054, "Unknown column 'JOINING_YEAR' in 'field list'")
[SQL: INSERT INTO `Employees3` (`index`, `PERSON`, `JOINING_YEAR`, `COMPANY`) VALUES (%(index)s, %(PERSON)s, %(JOINING_YEAR)s, %(COMPANY)s)]
[parameters: ({'index': 0, 'PERSON': 'John', 'JOINING_YEAR': 2018, 'COMPANY': 'Google'}, {'index': 1, 'PERSON': 'Sam', 'JOINING_YEAR': 2017, 'COMPANY': 'IBM'}, {'index': 2, 'PERSON': 'Jeff', 'JOINING_YEAR': 2014, 'COMPANY': 'Yahoo'}, {'index': 3, 'PERSON': 'Allen', 'JOINING_YEAR': 2015, 'COMPANY': 'Facebook'})]
(Background on this error at: http://sqlalche.me/e/13/2j85)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    self.dialect.do_executemany(
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 148, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 195, in executemany
    return self._do_execute_many(q_prefix, q_values, q_postfix, args,
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 234, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/usr/local/lib/python3.8/dist-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1054, "Unknown column 'JOINING_YEAR' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/airflow/models/taskinstance.py", line 983, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python_operator.py", line 113, in execute
    return_value = self.execute_callable()
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python_operator.py", line 118, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/bhakti/airflow/dags/csv_to_mysql.py", line 26, in csv_data_into_mysql
    data_file.to_sql('Employees3', conn, if_exists='append', index=True)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 2702, in to_sql
    sql.to_sql(
  File "/usr/local/lib/python3.8/dist-packages/pandas/io/sql.py", line 509, in to_sql
    pandas_sql.to_sql(
  File "/usr/local/lib/python3.8/dist-packages/pandas/io/sql.py", line 1320, in to_sql
    table.insert(chunksize, method=method)
  File "/usr/local/lib/python3.8/dist-packages/pandas/io/sql.py", line 756, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/usr/local/lib/python3.8/dist-packages/pandas/io/sql.py", line 670, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/engine/base.py", line 1014, in execute
    return meth(self, multiparams, params)
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/engine/base.py", line 1127, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    util.raise_(
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    self.dialect.do_executemany(
  File "/usr/local/lib/python3.8/dist-packages/sqlalchemy/dialects/mysql/mysqldb.py", line 148, in do_executemany
    rowcount = cursor.executemany(statement, parameters)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 195, in executemany
    return self._do_execute_many(q_prefix, q_values, q_postfix, args,
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 234, in _do_execute_many
    rows += self.execute(sql + postfix)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.8/dist-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/usr/local/lib/python3.8/dist-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.8/dist-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.InternalError: (pymysql.err.InternalError) (1054, "Unknown column 'JOINING_YEAR' in 'field list'")
[SQL: INSERT INTO `Employees3` (`index`, `PERSON`, `JOINING_YEAR`, `COMPANY`) VALUES (%(index)s, %(PERSON)s, %(JOINING_YEAR)s, %(COMPANY)s)]
[parameters: ({'index': 0, 'PERSON': 'John', 'JOINING_YEAR': 2018, 'COMPANY': 'Google'}, {'index': 1, 'PERSON': 'Sam', 'JOINING_YEAR': 2017, 'COMPANY': 'IBM'}, {'index': 2, 'PERSON': 'Jeff', 'JOINING_YEAR': 2014, 'COMPANY': 'Yahoo'}, {'index': 3, 'PERSON': 'Allen', 'JOINING_YEAR': 2015, 'COMPANY': 'Facebook'})]
(Background on this error at: http://sqlalche.me/e/13/2j85)
[2020-07-13 10:24:44,780] {taskinstance.py:1174} INFO - All retries failed; marking task as FAILED.dag_id=CSVDAG, task_id=csv_to_mysql, execution_date=20200713T045203, start_date=20200713T045444, end_date=20200713T045444
[2020-07-13 10:24:54,161] {logging_mixin.py:112} INFO - [2020-07-13 10:24:54,160] {local_task_job.py:103} INFO - Task exited with return code 1
